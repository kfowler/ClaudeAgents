# Development Process Guide for ClaudeAgents

**Version:** 1.0
**Last Updated:** 2025-10-06
**Status:** Mandatory for all contributors

This document defines the professional development process for ClaudeAgents, ensuring quality, traceability, and adherence to The Manifesto principles.

---

## Core Principles

1. **Always Work in Branches** - Never commit directly to `master`
2. **Atomic Commits** - One logical change per commit
3. **Leverage Expert Agents** - Use the right specialist for each task
4. **Document Agent Attribution** - Track which agent produced what work
5. **Follow Git Hygiene** - Clear messages, logical history, reviewable changes

---

## Standard Workflow

### Phase 1: Planning & Branch Creation

**Step 1: Create Feature Branch**
```bash
git checkout master
git pull origin master
git checkout -b claude/descriptive-feature-name
```

**Branch Naming Convention:**
- `claude/feature-name` - New features or analysis
- `claude/fix-issue-name` - Bug fixes
- `claude/docs-topic` - Documentation improvements
- `claude/refactor-component` - Code refactoring

**Step 2: Plan with Project Orchestrator (for complex work)**

For multi-step tasks requiring coordination:
```
User: "I need to add comprehensive architecture documentation"
Agent: Invoking project-orchestrator...
```

The orchestrator will:
- Decompose complex tasks into atomic deliverables
- Assign appropriate specialist agents
- Define commit boundaries for each deliverable
- Ensure proper sequencing and dependencies

**RED FLAG**: If you find yourself planning to create multiple large files (>500 lines) in a single commit, STOP. Return to project-orchestrator for proper decomposition.

---

## Mandatory Git Workflow

### Rule 1: NEVER Work Directly on Master

**VIOLATION EXAMPLE** (What NOT to do):
```bash
git checkout master
# Start working... ❌ WRONG!
```

**CORRECT APPROACH**:
```bash
git checkout master
git pull origin master
git checkout -b claude/feature-name
# Now you can work ✅
```

**Why This Matters:**
- Master is sacred - it represents production-ready state
- Direct commits to master bypass review processes
- Mistakes on master are harder to rollback
- Branch-based workflow enables parallel development
- Pull requests provide accountability and review

### Rule 2: Atomic Commits - One Logical Change Per Commit

An **atomic commit** contains:
- ONE logical change (e.g., "Add security agent" or "Fix validation bug")
- All files needed for that change to work
- Nothing extra or unrelated
- A clear, descriptive message

**VIOLATION EXAMPLE** (What NOT to do):
```bash
# Three agents created simultaneously
git add agents/security-expert.md
git add agents/qa-engineer.md
git add agents/devops-specialist.md
git commit -m "Add agents"  # ❌ TOO VAGUE, TOO BIG
```

**CORRECT APPROACH**:
```bash
# Commit 1: Security agent
git add agents/security-expert.md
git commit -m "$(cat <<'EOF'
Add security-expert agent for vulnerability assessment

Generated by: security-expert (self-documented)

This agent provides:
- OWASP Top 10 vulnerability scanning
- Dependency security audits
- Secure code review capabilities

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Commit 2: QA agent
git add agents/qa-engineer.md
git commit -m "$(cat <<'EOF'
Add qa-test-engineer for comprehensive testing strategies

Generated by: qa-test-engineer (self-documented)

This agent provides:
- Test plan development
- Unit/integration/e2e test implementation
- Test coverage analysis

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Commit 3: DevOps agent
git add agents/devops-specialist.md
git commit -m "$(cat <<'EOF'
Add devops-engineer for CI/CD and infrastructure automation

Generated by: devops-engineer (self-documented)

This agent provides:
- Docker containerization
- Kubernetes orchestration
- CI/CD pipeline setup

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

### Rule 3: Commit After Each Agent Deliverable

**When to commit:**
- ✅ Immediately after an agent completes a deliverable
- ✅ After validation passes for that deliverable
- ✅ When a logical unit of work is complete and tested
- ✅ Before switching to a different agent or task

**When NOT to commit:**
- ❌ At the end of the day with all work batched together
- ❌ When files are incomplete or broken
- ❌ Before running validation/tests
- ❌ With unrelated changes mixed together

**REAL VIOLATION EXAMPLE** (from recent work):
```bash
# What happened (WRONG ❌):
# - Created ARCHITECTURE_REVIEW.md (1544 lines)
# - Created TODO-IMPROVEMENTS.md (743 lines)
# - Created docs/users-guide.md (2216 lines)
# - Total: 4503 lines in ONE commit

git add ARCHITECTURE_REVIEW.md TODO-IMPROVEMENTS.md docs/users-guide.md
git commit -m "Add documentation"  # ❌ MASSIVE VIOLATION
```

**What SHOULD have happened (CORRECT ✅):**
```bash
# Step 1: Delegate architecture review to code-architect
# Agent: code-architect analyzes codebase
git add ARCHITECTURE_REVIEW.md
git commit -m "$(cat <<'EOF'
Add architecture review from code-architect analysis

Generated by: code-architect

Comprehensive analysis covering:
- Design patterns and anti-patterns
- Coupling and cohesion metrics
- Technical debt assessment
- Improvement recommendations

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Step 2: Delegate TODO prioritization to project-orchestrator
# Agent: project-orchestrator creates improvement roadmap
git add TODO-IMPROVEMENTS.md
git commit -m "$(cat <<'EOF'
Add improvement roadmap from architecture analysis

Generated by: project-orchestrator

Prioritized action plan based on architecture review:
- Sprint-based organization
- Effort vs impact analysis
- Dependency mapping

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Step 3: Delegate user guide to technical-writer (or appropriate agent)
# Agent: Creates comprehensive documentation
git add docs/users-guide.md
git commit -m "$(cat <<'EOF'
Add comprehensive users guide for Claude Code agents

Generated by: technical-writer

Complete reference documentation covering:
- Agent system overview
- Quick start guides
- Advanced orchestration patterns
- Troubleshooting and FAQs

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

### Rule 4: Commit Message Format with Agent Attribution

**Standard Format:**
```
Brief summary (50 chars or less)

Detailed explanation:
- What changed
- Why it changed
- Impact of changes

Generated by: agent-name

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

**Key Elements:**
1. **Subject line**: Imperative mood, <50 chars ("Add X", "Fix Y", "Update Z")
2. **Body**: Explain WHY, not just WHAT
3. **Agent attribution**: `Generated by: agent-name`
4. **Claude Code signature**: Standard footer for attribution

**Examples:**

**GOOD Commit Message ✅:**
```
Add accessibility-expert agent for WCAG compliance

Generated by: accessibility-expert (self-documented)

This agent provides:
- WCAG 2.1 Level AA/AAA compliance auditing
- Semantic HTML review
- ARIA implementation guidance
- Screen reader compatibility testing
- Keyboard navigation assessment

Enables automated accessibility reviews in development workflow.

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

**BAD Commit Messages ❌:**
```
# Too vague
Add stuff

# No agent attribution
Add three new agents for security, testing, and deployment

# No explanation
Update files

# Not atomic
Add agents, fix bugs, update docs, refactor code
```

---

## Agent Delegation Best Practices

### Core Principle: Leverage Specialist Agents

**YOU ARE THE COORDINATOR, NOT THE IMPLEMENTER.**

Your role is to:
1. Understand what needs to be done
2. Identify the right agent(s) for the job
3. Delegate to specialists
4. Validate deliverables
5. Commit work with proper attribution

**VIOLATION**: Doing agent work yourself instead of delegating.

### How to Identify the Right Agent

**Use this decision tree:**

```
Is this a complex multi-step task?
├─ YES → Start with project-orchestrator
│         (It will identify and coordinate specialists)
└─ NO → Determine domain:
        ├─ Architecture/Code Quality → code-architect
        ├─ Security → security-audit-specialist
        ├─ Testing → qa-test-engineer
        ├─ Documentation → (use general capabilities or create technical-writer)
        ├─ Infrastructure → devops-engineer
        ├─ Database → data-engineer
        ├─ Web Development → full-stack-architect
        ├─ Mobile → mobile-developer
        ├─ AI/ML → ai-ml-engineer
        └─ Legacy Systems → legacy-specialist
```

**Examples:**

| Task | Wrong Approach ❌ | Correct Approach ✅ |
|------|------------------|-------------------|
| Write architecture review | Manually analyze and write document | Delegate to `code-architect` |
| Create improvement TODO list | Manually list improvements | Delegate to `project-orchestrator` |
| Write user documentation | Write it yourself | Delegate to appropriate agent |
| Add new agent | Copy template and write it | Use agent expertise (may self-document) |
| Security audit | Run tools and write report | Delegate to `security-audit-specialist` |

### When to Use project-orchestrator

**Use project-orchestrator when:**
- Task involves 3+ distinct steps
- Multiple specialist agents are needed
- Work needs to be sequenced/coordinated
- Unclear which agents to use
- Need task decomposition

**Example:**

```
User: "We need to improve the entire ClaudeAgents codebase"

BAD Approach ❌:
- Manually analyze everything
- Write giant documents
- Create massive commit

GOOD Approach ✅:
1. Invoke: project-orchestrator
2. Project-orchestrator delegates:
   - Phase 1: code-architect (architectural analysis)
   - Phase 2: security-audit-specialist (security review)
   - Phase 3: qa-test-engineer (test strategy)
   - Phase 4: technical-writer (documentation)
3. Each agent delivers, you commit atomically
4. Project-orchestrator validates integration
```

### Agent Attribution in Commits

**Why Agent Attribution Matters:**
- **Accountability**: Know which agent produced what
- **Quality tracking**: Measure agent effectiveness
- **Debugging**: Trace issues to specific agent outputs
- **Learning**: Understand agent capabilities
- **Trust**: Transparent about AI-generated content

**Attribution Format:**
```
Generated by: agent-name
```

**Special Cases:**
```
# Self-documented agent
Generated by: security-expert (self-documented)

# Multi-agent collaboration
Generated by: project-orchestrator
Contributions from: code-architect, qa-test-engineer

# Human-guided agent work
Generated by: full-stack-architect
Human guidance: Architecture decisions by @username
```

### Don't Do Agent Work Yourself

**RED FLAGS that you're violating delegation:**
- Writing 1000+ line documents manually
- Analyzing code yourself instead of using code-architect
- Creating test plans instead of using qa-test-engineer
- Manually writing security reports instead of using security-audit-specialist
- Skipping agents because "it's faster to do it myself"

**The Test:**
Before creating or editing a file, ask:
> "Is there an agent that specializes in this type of work?"

If YES → Delegate to that agent
If NO but task is substantial → Use project-orchestrator to coordinate
If NO and task is trivial → Proceed, but document why

---

## Development Phases

### Phase 1: Planning & Branch Creation

**Steps:**
1. **Create feature branch** (BEFORE any work)
   ```bash
   git checkout master
   git pull origin master
   git checkout -b claude/descriptive-name
   ```

2. **Decompose complex tasks**
   - For multi-step work: Invoke `project-orchestrator`
   - For single-agent work: Identify specialist
   - Document the plan (can be in commit message or PR description)

3. **Validate prerequisites**
   - Check if similar work exists
   - Identify dependencies
   - Ensure you have necessary context

**Commit at this phase:** ONLY if you create planning documents (e.g., PLAN.md)

### Phase 2: Execution

**Steps:**
1. **Delegate to first agent**
   - Invoke appropriate specialist
   - Provide clear context and requirements
   - Wait for deliverable

2. **Validate deliverable**
   ```bash
   # For agents:
   python3 tools/validate_agents.py

   # For code:
   python3 -m pytest tests/ -v

   # For documentation:
   # Manual review for clarity
   ```

3. **Commit immediately**
   ```bash
   git add [files-from-this-agent]
   git commit -m "$(cat <<'EOF'
   [Descriptive message]

   Generated by: [agent-name]

   [Details]

   🤖 Generated with [Claude Code](https://claude.com/claude-code)

   Co-Authored-By: Claude <noreply@anthropic.com>
   EOF
   )"
   ```

4. **Repeat for next agent/task**
   - One agent deliverable = one commit
   - Maintain atomic commit discipline
   - Don't batch multiple deliverables

**Key Rules:**
- ✅ Commit after EACH agent deliverable
- ✅ Validate BEFORE committing
- ✅ Include agent attribution
- ❌ NEVER batch multiple agent outputs into one commit
- ❌ NEVER commit broken/unvalidated work

### Phase 3: Review

**Steps:**
1. **Self-review**
   ```bash
   git log --oneline [base-branch]..HEAD
   git diff [base-branch]...HEAD
   ```

   Verify:
   - All commits are atomic
   - All commits have agent attribution
   - Commit messages are clear
   - No files are missing
   - No unrelated changes included

2. **Agent review** (if appropriate)
   - Use `code-architect` for architectural review
   - Use `qa-test-engineer` for test coverage review
   - Use `security-audit-specialist` for security review

3. **Address issues**
   - Fix issues in new commits (don't rewrite history)
   - Each fix = atomic commit
   - Maintain attribution

### Phase 4: Integration

**Steps:**
1. **Sync with base branch**
   ```bash
   git fetch origin
   git rebase origin/master  # or merge if preferred
   ```

2. **Final validation**
   ```bash
   python3 tools/validate_agents.py
   python3 -m pytest tests/ -v
   ```

3. **Push to remote**
   ```bash
   git push -u origin claude/feature-name
   ```

4. **Create pull request**
   ```bash
   gh pr create --title "Clear descriptive title" --body "$(cat <<'EOF'
   ## Summary
   - Brief overview of changes
   - Why these changes were needed
   - Impact on system

   ## Agent Attribution
   - agent-1: Deliverable X
   - agent-2: Deliverable Y
   - agent-3: Deliverable Z

   ## Testing
   - [ ] Validation passes
   - [ ] Tests pass
   - [ ] Manual testing completed

   ## Checklist
   - [ ] All commits are atomic
   - [ ] All commits have agent attribution
   - [ ] Documentation updated
   - [ ] No sensitive data included

   🤖 Generated with [Claude Code](https://claude.com/claude-code)
   EOF
   )"
   ```

---

## Anti-Patterns

### Anti-Pattern 1: Working on Master Directly ❌

**Violation:**
```bash
git checkout master
# Make changes directly
git commit -m "Quick fix"
git push origin master
```

**Why It's Bad:**
- Bypasses review process
- No rollback safety net
- Breaks parallel development
- Violates professional standards

**How to Fix:**
```bash
# If you realize you're on master with uncommitted changes:
git stash
git checkout -b claude/fix-branch-name
git stash pop
# Continue work on branch
```

**Prevention:**
- Always check branch before starting work: `git branch --show-current`
- Use git hooks (see Process Enforcement section)
- Make it a habit: `git checkout -b` is your first command

### Anti-Pattern 2: 1000+ Line Commits ❌

**Violation Example** (REAL from this repo):
```bash
# Added in ONE commit:
ARCHITECTURE_REVIEW.md     | 1544 lines
TODO-IMPROVEMENTS.md        |  743 lines
docs/users-guide.md         | 2216 lines
---------------------------------
TOTAL                       | 4503 lines ❌
```

**Why It's Bad:**
- Impossible to review effectively
- Can't isolate issues
- Hard to revert if needed
- Violates atomic commit principle
- No clear attribution

**How It Should Have Been Done:**
```bash
# Commit 1 (code-architect deliverable):
ARCHITECTURE_REVIEW.md      | 1544 lines
Generated by: code-architect

# Commit 2 (project-orchestrator deliverable):
TODO-IMPROVEMENTS.md        |  743 lines
Generated by: project-orchestrator

# Commit 3 (technical-writer deliverable):
docs/users-guide.md         | 2216 lines
Generated by: technical-writer
```

**Size Guidelines:**
- **Ideal commit**: <200 lines changed
- **Acceptable**: 200-500 lines (if cohesive)
- **Warning**: 500-1000 lines (consider splitting)
- **VIOLATION**: >1000 lines (MUST split into multiple commits)

**How to Fix When You Realize:**
```bash
# If changes are uncommitted:
git add -p  # Interactively stage related changes
git commit -m "First logical unit"
git add -p  # Stage next related changes
git commit -m "Second logical unit"

# If already committed (on feature branch only):
git reset HEAD~1  # Uncommit (keep changes)
# Now commit atomically as above
```

### Anti-Pattern 3: Doing Agent Work Manually ❌

**Violation Example:**
```
Task: "Create architecture review"

WRONG ❌:
1. You manually analyze codebase
2. You write 1544-line document
3. You commit it yourself
```

**Correct Approach ✅:**
```
Task: "Create architecture review"

RIGHT ✅:
1. Invoke code-architect agent
2. Agent analyzes codebase
3. Agent produces ARCHITECTURE_REVIEW.md
4. You validate output
5. You commit with attribution: "Generated by: code-architect"
```

**How to Recognize This Anti-Pattern:**
- You're writing long documents yourself
- You're analyzing code patterns manually
- You're creating test plans without qa-test-engineer
- You're doing work that an agent specializes in

**Fix:**
- STOP immediately
- Identify appropriate agent
- Delegate the work
- Commit agent output with attribution

### Anti-Pattern 4: No Agent Attribution ❌

**Violation:**
```bash
git commit -m "Add architecture review"
# No mention of which agent created it ❌
```

**Correct:**
```bash
git commit -m "$(cat <<'EOF'
Add architecture review from code-architect analysis

Generated by: code-architect

[Details of what was analyzed and found]

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

**Why Attribution Matters:**
- Transparency about AI-generated content
- Quality tracking per agent
- Debugging and accountability
- Professional standards

### Anti-Pattern 5: Batching Commits ❌

**Violation:**
```bash
# Work all day on multiple tasks
# At 5pm:
git add .
git commit -m "Today's work"  # ❌
```

**Correct:**
```bash
# After first agent completes:
git add [agent-1-files]
git commit -m "[Agent 1 deliverable]"

# After second agent completes:
git add [agent-2-files]
git commit -m "[Agent 2 deliverable]"

# After third agent completes:
git add [agent-3-files]
git commit -m "[Agent 3 deliverable]"
```

**Benefits of Immediate Commits:**
- Clear atomic history
- Easy to review
- Simple to revert if needed
- Proper attribution
- Professional git hygiene

---

## Examples: Before/After

### Example 1: Architecture Improvement Project

#### BAD Approach ❌

```bash
# Working on master
git checkout master

# Create everything manually
vim ARCHITECTURE_REVIEW.md    # (1544 lines)
vim TODO-IMPROVEMENTS.md       # (743 lines)
vim docs/users-guide.md        # (2216 lines)

# One massive commit
git add .
git commit -m "Add documentation"
git push origin master
```

**Problems:**
- ❌ Working on master
- ❌ 4503 lines in one commit
- ❌ No agent delegation
- ❌ No agent attribution
- ❌ No atomic commits
- ❌ Unprofessional workflow

#### GOOD Approach ✅

```bash
# Step 1: Create feature branch
git checkout master
git pull origin master
git checkout -b claude/architecture-improvements

# Step 2: Plan with orchestrator
# Invoke: project-orchestrator
# Output: Plan with 3 phases

# Step 3: Execute Phase 1 - Architecture Analysis
# Invoke: code-architect
# Agent produces: ARCHITECTURE_REVIEW.md

# Validate
cat ARCHITECTURE_REVIEW.md  # Review output
python3 tools/validate_agents.py  # If it references agents

# Commit atomically
git add ARCHITECTURE_REVIEW.md
git commit -m "$(cat <<'EOF'
Add comprehensive architecture review

Generated by: code-architect

Comprehensive analysis covering:
- Design patterns and anti-patterns (15 patterns identified)
- Coupling and cohesion metrics (average coupling: low)
- Technical debt assessment (12% ratio)
- Security considerations (OWASP Top 10 coverage)
- Performance optimization opportunities (3 critical paths)

Key findings:
- Agent system architecture is sound (hexagonal pattern)
- Validation infrastructure is robust
- Documentation debt identified as primary improvement area

Recommendations organized by priority and effort.

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Step 4: Execute Phase 2 - Improvement Roadmap
# Invoke: project-orchestrator
# Agent produces: TODO-IMPROVEMENTS.md

# Validate
cat TODO-IMPROVEMENTS.md

# Commit atomically
git add TODO-IMPROVEMENTS.md
git commit -m "$(cat <<'EOF'
Add prioritized improvement roadmap

Generated by: project-orchestrator
Input from: code-architect (architecture review)

Sprint-based improvement plan addressing:
- Critical validation fixes (Sprint 1)
- Testing infrastructure (Sprint 2)
- Documentation debt (Sprint 3)
- Polish and optimization (Sprint 4)

Each sprint includes:
- Effort estimates (S/M/L)
- Impact assessment (High/Medium/Low)
- Dependencies and sequencing
- Success criteria

Estimated total: 4 sprints over 8 weeks

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Step 5: Execute Phase 3 - User Documentation
# Invoke: appropriate agent for documentation
# Agent produces: docs/users-guide.md

# Validate
cat docs/users-guide.md

# Commit atomically
git add docs/users-guide.md
git commit -m "$(cat <<'EOF'
Add comprehensive users guide for Claude Code agents

Generated by: technical-writer

Complete reference documentation covering:
- Quick start (5-minute onboarding)
- Agent system concepts and architecture
- Common workflows (web dev, mobile, AI/ML)
- Advanced orchestration patterns
- Troubleshooting and FAQs
- Best practices and anti-patterns

Includes:
- 15 detailed examples
- Decision trees for agent selection
- Comparison tables for agent capabilities
- Integration guides for common tools

Target audience: Developers new to Claude Code agents

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Step 6: Push and create PR
git push -u origin claude/architecture-improvements

gh pr create --title "Architecture improvements and comprehensive documentation" --body "$(cat <<'EOF'
## Summary
Complete architecture review and improvement roadmap based on code-architect analysis.

### Changes
- **ARCHITECTURE_REVIEW.md**: Comprehensive analysis by code-architect
- **TODO-IMPROVEMENTS.md**: 4-sprint improvement roadmap by project-orchestrator
- **docs/users-guide.md**: Complete user documentation

### Agent Attribution
- code-architect: Architecture analysis (1544 lines)
- project-orchestrator: Improvement roadmap (743 lines)
- technical-writer: User documentation (2216 lines)

### Key Findings
- Architecture is sound (hexagonal pattern implemented correctly)
- Documentation debt is primary improvement area
- Validation infrastructure is robust
- 12% technical debt ratio (acceptable range)

### Next Steps
1. Review and merge this PR
2. Begin Sprint 1: Critical validation fixes
3. Implement testing infrastructure (Sprint 2)
4. Address documentation debt (Sprint 3)

## Testing
- [x] All commits are atomic
- [x] All commits have agent attribution
- [x] Validation passes
- [x] Manual review completed

🤖 Generated with [Claude Code](https://claude.com/claude-code)
EOF
)"
```

**Benefits:**
- ✅ Proper branching
- ✅ 3 atomic commits
- ✅ Clear agent delegation
- ✅ Proper attribution
- ✅ Professional workflow
- ✅ Reviewable history

### Example 2: Adding Three New Agents

#### BAD Approach ❌

```bash
# Create all three agents manually
vim agents/security-expert.md       # 300 lines
vim agents/qa-engineer.md           # 250 lines
vim agents/performance-specialist.md # 280 lines

# One big commit
git add agents/
git commit -m "Add new agents"  # ❌
```

**Problems:**
- ❌ No atomic commits
- ❌ Vague commit message
- ❌ No agent attribution
- ❌ Can't track which agent does what

#### GOOD Approach ✅

```bash
# Commit 1: Security Expert
git add agents/security-expert.md
git commit -m "$(cat <<'EOF'
Add security-expert agent for vulnerability assessment

Generated by: security-expert (self-documented)

Provides comprehensive security analysis:
- OWASP Top 10 vulnerability scanning
- Dependency security audits (npm audit, Snyk integration)
- Secure code review (injection, XSS, CSRF patterns)
- Authentication/authorization review
- Security headers and HTTPS configuration
- Secrets detection (API keys, passwords)

Deliverables:
- Security assessment reports
- Vulnerability remediation plans
- Secure coding recommendations
- Compliance checklists (SOC2, GDPR, HIPAA)

Integration: Works with qa-test-engineer for security testing

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Commit 2: QA Engineer
git add agents/qa-engineer.md
git commit -m "$(cat <<'EOF'
Add qa-test-engineer for comprehensive testing

Generated by: qa-test-engineer (self-documented)

Provides testing expertise:
- Test strategy development (unit, integration, e2e)
- Test plan creation and review
- Test implementation (Jest, Pytest, Cypress)
- Coverage analysis and improvement
- Regression test suites
- Performance testing integration

Deliverables:
- Test plans with success criteria
- Implemented test suites
- Coverage reports with recommendations
- CI/CD testing integration

Integration: Works with security-expert for security testing

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Commit 3: Performance Specialist
git add agents/performance-specialist.md
git commit -m "$(cat <<'EOF'
Add performance-specialist for optimization

Generated by: performance-specialist (self-documented)

Provides performance optimization:
- Performance profiling (CPU, memory, I/O)
- Bottleneck identification
- Algorithmic complexity analysis
- Database query optimization
- Caching strategy development
- Load testing and benchmarking

Deliverables:
- Performance audit reports
- Optimization recommendations with estimates
- Before/after benchmarks
- Monitoring and alerting setup

Integration: Works with devops-engineer for infrastructure optimization

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

**Benefits:**
- ✅ 3 atomic commits (one per agent)
- ✅ Clear purpose for each commit
- ✅ Easy to review individually
- ✅ Simple to revert if needed
- ✅ Clear agent capabilities documented

### Example 3: Bug Fix with Testing

#### BAD Approach ❌

```bash
# Fix bug and add tests together
vim agents/validator.py      # Fix bug
vim tests/test_validator.py  # Add tests
vim docs/changelog.md        # Update changelog

git add .
git commit -m "Fix and test"  # ❌
```

**Problems:**
- ❌ Multiple logical changes in one commit
- ❌ Hard to isolate the fix vs the test
- ❌ Unclear commit message

#### GOOD Approach ✅

```bash
# Commit 1: Bug fix
git add agents/validator.py
git commit -m "$(cat <<'EOF'
Fix validation error for multi-line descriptions

Generated by: code-architect

Problem: Validator was failing on descriptions with colons
in multi-line format, even when properly quoted.

Root cause: Regex pattern didn't account for YAML multi-line
syntax (| and >).

Solution: Updated pattern to support literal (|) and folded (>)
multi-line scalars in YAML.

Impact: Fixes validation for 12 existing agents with complex
descriptions.

Testing: Manual validation passes. Automated tests in next commit.

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Commit 2: Tests for the fix
git add tests/test_validator.py
git commit -m "$(cat <<'EOF'
Add tests for multi-line description validation

Generated by: qa-test-engineer

Test cases added:
- test_multiline_literal_block_descriptions
- test_multiline_folded_block_descriptions
- test_multiline_with_colons
- test_multiline_with_quotes

Coverage: Validates all YAML multi-line formats
- Literal blocks (|)
- Folded blocks (>)
- With colons
- With internal quotes

All tests pass. Coverage increased from 87% to 92%.

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Commit 3: Documentation
git add docs/changelog.md
git commit -m "$(cat <<'EOF'
Document validation fix in changelog

Generated by: technical-writer

Added entry for v1.2.1:
- Fixed multi-line description validation
- Added comprehensive test coverage
- Updated validation documentation

Links to commits for detailed changes.

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

**Benefits:**
- ✅ Clear separation: fix, test, docs
- ✅ Easy to review each change
- ✅ Can cherry-pick fix if needed
- ✅ Clear attribution per commit
- ✅ Professional git history

---

## Process Enforcement

### Pre-Commit Validation Hook

Create `.git/hooks/pre-commit`:

```bash
#!/bin/bash

# Check if we're on master
current_branch=$(git branch --show-current)
if [ "$current_branch" = "master" ]; then
    echo "❌ ERROR: You are trying to commit directly to master!"
    echo "Please create a feature branch:"
    echo "  git checkout -b claude/your-feature-name"
    exit 1
fi

# Check commit size
files_changed=$(git diff --cached --numstat | wc -l)
lines_changed=$(git diff --cached --numstat | awk '{sum+=$1+$2} END {print sum}')

if [ "$lines_changed" -gt 1000 ]; then
    echo "⚠️  WARNING: This commit changes $lines_changed lines"
    echo "Consider breaking into smaller atomic commits."
    echo ""
    echo "Press Enter to continue anyway, or Ctrl+C to cancel"
    read
fi

# Run validation if agent files changed
if git diff --cached --name-only | grep -q "^agents/.*\.md$"; then
    echo "Running agent validation..."
    python3 tools/validate_agents.py
    if [ $? -ne 0 ]; then
        echo "❌ Validation failed. Fix errors before committing."
        exit 1
    fi
fi

# Run tests if code files changed
if git diff --cached --name-only | grep -q "\.py$"; then
    echo "Running tests..."
    python3 -m pytest tests/ -v
    if [ $? -ne 0 ]; then
        echo "❌ Tests failed. Fix before committing."
        exit 1
    fi
fi

exit 0
```

Make it executable:
```bash
chmod +x .git/hooks/pre-commit
```

### Branch Protection Setup

Configure branch protection for `master`:

```bash
# Using GitHub CLI
gh api repos/:owner/:repo/branches/master/protection \
  --method PUT \
  --field required_status_checks='{"strict":true,"contexts":["validation","tests"]}' \
  --field enforce_admins=true \
  --field required_pull_request_reviews='{"required_approving_review_count":1}' \
  --field restrictions=null
```

Or via GitHub UI:
1. Settings → Branches → Add rule
2. Branch name pattern: `master`
3. Require pull request reviews (1 approval)
4. Require status checks (validation, tests)
5. Require branches to be up to date

### Pre-Merge Checklist

Before creating a pull request, verify:

```bash
# 1. All commits are atomic
git log --oneline origin/master..HEAD
# Review: Each commit = one logical change?

# 2. All commits have agent attribution
git log origin/master..HEAD | grep "Generated by:"
# Review: Every commit attributed?

# 3. Commit messages are clear
git log origin/master..HEAD
# Review: Clear what/why for each commit?

# 4. No unrelated changes
git diff origin/master...HEAD
# Review: Every change belongs to this feature?

# 5. Validation passes
python3 tools/validate_agents.py

# 6. Tests pass
python3 -m pytest tests/ -v

# 7. No sensitive data
git diff origin/master...HEAD | grep -i -E "(password|secret|key|token)"
# Should return nothing
```

If all checks pass:
```bash
# Create PR
gh pr create --title "Clear title" --body "..."
```

### Recovery from Violations

#### Scenario 1: Committed to Master Accidentally

```bash
# 1. Don't panic!
# 2. Create branch from current state
git branch claude/recovery-branch

# 3. Reset master to origin
git checkout master
git reset --hard origin/master

# 4. Continue work on recovery branch
git checkout claude/recovery-branch

# 5. Create PR as normal
gh pr create --title "..." --body "..."
```

#### Scenario 2: One Massive Commit

**If NOT pushed yet:**
```bash
# 1. Uncommit (keep changes)
git reset HEAD~1

# 2. Stage and commit atomically
git add file1.md
git commit -m "First logical unit with attribution"

git add file2.md
git commit -m "Second logical unit with attribution"

git add file3.md
git commit -m "Third logical unit with attribution"
```

**If already pushed:**
```bash
# 1. Create fixup commits on same branch
git add file-with-improvements.md
git commit -m "Add missing tests for feature X

Generated by: qa-test-engineer

[Details]"

# 2. Note in PR description:
"Note: Initial commit was too large. Subsequent commits
add missing pieces atomically."

# 3. Learn for next time!
```

#### Scenario 3: No Agent Attribution

**If NOT pushed yet:**
```bash
# Amend last commit
git commit --amend

# Update message to include:
# Generated by: agent-name
```

**If already pushed:**
```bash
# Add comment in PR:
"Note: Commits X, Y, Z generated by [agent-name]"

# Learn for next time!
```

#### Scenario 4: Did Agent Work Manually

**If NOT pushed yet:**
```bash
# 1. Stash your work
git stash

# 2. Delegate to proper agent
# Invoke: appropriate-agent

# 3. If agent output differs from your work:
git stash pop
# Merge agent wisdom with your work

# 4. Commit with agent attribution
git commit -m "...
Generated by: agent-name
Human guidance: [what you contributed]
..."
```

**If already pushed:**
```bash
# 1. Note in PR:
"Note: This work should have been delegated to [agent-name].
Future similar work will use proper agent delegation."

# 2. Learn for next time!
```

---

## Quick Reference

### ✅ DO

- **ALWAYS** create a branch before starting work
- **ALWAYS** commit after each agent deliverable
- **ALWAYS** include agent attribution in commits
- **ALWAYS** keep commits atomic (<500 lines ideal)
- **ALWAYS** delegate to specialist agents
- **ALWAYS** validate before committing
- **ALWAYS** use descriptive commit messages

### ❌ DON'T

- **NEVER** work directly on master
- **NEVER** create commits >1000 lines
- **NEVER** batch multiple agent deliverables into one commit
- **NEVER** commit without agent attribution
- **NEVER** do specialist work yourself
- **NEVER** skip validation
- **NEVER** commit broken/incomplete work

### Common Commands

```bash
# Start new work
git checkout master && git pull && git checkout -b claude/feature-name

# Commit agent deliverable
git add [files]
git commit -m "$(cat <<'EOF'
[Summary]

Generated by: [agent-name]

[Details]

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

# Validate before committing
python3 tools/validate_agents.py
python3 -m pytest tests/ -v

# Create PR
gh pr create --title "[title]" --body "[description]"

# Check current branch (do this often!)
git branch --show-current
```

### Emergency Recovery

```bash
# On master accidentally?
git branch claude/recovery && git checkout master && git reset --hard origin/master && git checkout claude/recovery

# Commit too big?
git reset HEAD~1  # Then commit atomically

# Forgot attribution?
git commit --amend  # Add it

# Did agent work manually?
git stash  # Invoke agent, then merge
```

---

## Measuring Success

Track these metrics to ensure process adherence:

### Commit Quality Metrics

- **Average commit size**: Target <300 lines
- **Agent attribution rate**: Target 100%
- **Atomic commit rate**: Target 100%
- **Master protection violations**: Target 0

### Process Adherence

- **Branch-first workflow**: 100% of work on branches
- **Immediate commits**: Commit within 5 min of agent deliverable
- **Agent delegation rate**: 90%+ of specialist work delegated
- **Validation pass rate**: 100% before commits

### Review Quality

- **PR review time**: <24 hours
- **Commits per PR**: Target 3-10 (not 1 or 50)
- **Review cycles**: Target 1-2 (indicates good initial quality)

---

## Conclusion

Professional development requires discipline:

1. **Branch first** - Never touch master directly
2. **Atomic commits** - One logical change, one commit
3. **Delegate to agents** - Use specialists, don't do their work
4. **Attribute properly** - Credit agents for their work
5. **Validate always** - Don't commit broken work

**The test of good process:**
> "Can someone review my PR in 30 minutes and understand exactly what changed, why it changed, and who produced each change?"

If YES → Good process ✅
If NO → Process violation ❌

**Remember:** These processes exist to:
- Maintain code quality
- Enable team collaboration
- Provide accountability
- Support long-term maintainability
- Reflect professional standards

---

**Questions?** See [CONTRIBUTING.md](contributing.md) for more details.

**Need help?** Review examples in this guide or ask project-orchestrator for guidance.

**Found a better way?** Propose improvements via PR following this process!